{% extends "base.html" %} {% block title %}ãƒ¡ãƒ¼ãƒ«è©³ç´° -
è„†å¼±ãªã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ«{% endblock %} {% block content %}
<div class="container mt-4">
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">
          <h3>{{ email[3] }}</h3>
          <small class="text-muted">
            é€ä¿¡è€…: {{ email[8] }} | å—ä¿¡æ—¥æ™‚: {{ email[6] }}
          </small>
        </div>
        <div class="card-body">
          <div class="mb-4">{{ email[4]|safe }}</div>

          <!-- XSSè„†å¼±æ€§: mailidãŒã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼å†…ã«åå°„ -->
          <div class="alert alert-info">
            <strong>ğŸ“§ ãƒ¡ãƒ¼ãƒ«æ“ä½œ:</strong>
            <button 
              class="btn btn-sm btn-secondary ms-2" 
              onclick="handleMailAction('{{ mailid|safe }}'); return false;"
              title="ãƒ¡ãƒ¼ãƒ«ID: {{ filtered_mailid }}"
            >
              ğŸ”„ æ›´æ–°
            </button>
            <button 
              class="btn btn-sm btn-danger ms-2" 
              onclick="confirmDelete('{{ mailid|safe }}'); return false;"
            >
              ğŸ—‘ï¸ å‰Šé™¤
            </button>
          </div>

          {% if attachments %}
          <hr />
          <h5>ğŸ“ æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«</h5>
          <div class="list-group">
            {% for attachment in attachments %}
            <div
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <div>
                <strong>{{ attachment[2] }}</strong>
                <small class="text-muted"
                  >({{ attachment[5]|filesizeformat }})</small
                >
              </div>
              <a
                href="/mail/attachment/{{ attachment[0] }}"
                class="btn btn-sm btn-outline-primary"
              >
                ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
              </a>
            </div>
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </div>

      <div class="mt-3">
        <a href="/mail/inbox" class="btn btn-secondary">â† å—ä¿¡ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹</a>
        <a href="/mail/sent" class="btn btn-secondary">â† é€ä¿¡ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹</a>
        <a href="/mail/compose" class="btn btn-primary">âœï¸ æ–°è¦ãƒ¡ãƒ¼ãƒ«</a>
      </div>
    </div>
  </div>
</div>

<script>
function handleMailAction(mailId) {
    // è„†å¼±æ€§: mailidãŒJavaScriptå†…ã«åå°„ã•ã‚Œã‚‹
    console.log('Mail action for ID: ' + mailId);
    alert('ãƒ¡ãƒ¼ãƒ«æ“ä½œãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ (ID: ' + mailId + ')');
}

function confirmDelete(mailId) {
    // è„†å¼±æ€§: mailidãŒJavaScriptå†…ã«åå°„ã•ã‚Œã‚‹
    if (confirm('ãƒ¡ãƒ¼ãƒ«ID ' + mailId + ' ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
        console.log('Deleting mail ID: ' + mailId);
        alert('å‰Šé™¤æ©Ÿèƒ½ã¯å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã›ã‚“ (ID: ' + mailId + ')');
    }
}
</script>
{% endblock %}
